<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ì‹ ê°€ë„¤ ë§ˆë‹ˆë˜ ì¡°íšŒ</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap');

  body {
    font-family: "Pretendard", sans-serif;
    margin: 0;
    padding: 0;
    background: #f0f4f8;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
  }

  .bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 60%; /* í™”ë©´ ì„¸ë¡œ ê¸°ì¤€ 60%ë§Œ ì°¨ì§€ */
    background-image: url('ì•„ë²„ì§€.jpg');
    background-size: auto 100%; /* ì›ë³¸ ë¹„ìœ¨ ìœ ì§€ */
    background-position: center top; /* ì–¼êµ´ì´ ìœ„ìª½ ì¤‘ì•™ì— ì˜¤ë„ë¡ */
    background-repeat: no-repeat;
    z-index: -2;
  }

  .overlay {
    position: fixed;
    top:0; left:0;
    width:100%; height:60%;
    background: rgba(0,0,0,0.15); /* ì‚´ì§ ì–´ë‘¡ê²Œ */
    z-index:-1;
  }

  .container {
    max-width: 500px;
    width: 95%;
    margin: auto;
    margin-top: 65%; /* ì‚¬ì§„ ì•„ë˜ë¡œ ì´ë™ */
    background: rgba(255,255,255,0.85);
    padding: 28px 24px;
    border-radius: 25px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    backdrop-filter: blur(3px);
    text-align: center;
    animation: fadeIn 0.8s ease-in-out;
  }

  h2 {
    font-size: 26px;
    font-weight: 700;
    margin-bottom: 20px;
    color: #333;
  }

  h3 {
    font-size: 18px;
    font-weight: 600;
    margin-top: 24px;
    color: #555;
  }

  input {
    max-width: 100%;
    padding: 14px;
    margin-bottom: 14px;
    border-radius: 12px;
    border: 1px solid #ccc;
    font-size: 16px;
    outline: none;
    transition: 0.2s;
  }

  input:focus {
    border-color: #007bff;
    box-shadow: 0 0 8px rgba(0,123,255,0.2);
  }

  button {
    max-width: 100%;
    padding: 14px;
    border: none;
    border-radius: 12px;
    background: linear-gradient(90deg,#4a90e2,#007bff);
    color: white;
    font-size: 17px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.3s;
  }

  button:hover {
    background: linear-gradient(90deg,#007bff,#005fcc);
  }

  .result {
    margin-top: 22px;
    font-size: 18px;
    font-weight: 600;
    color: #333;
    line-height: 1.5;
    min-height: 60px;
  }

  .highlight {
    color: #28a745;
    font-weight: 700;
    font-size: 20px;
  }

  #passwordList {
    margin-top: 16px;
    font-size: 15px;
    line-height: 1.5;
    color: #555;
    text-align: left;
    max-height: 180px;
    overflow-y: auto;
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 12px;
    background: #f9f9f9;
  }

  hr {
    margin: 22px 0;
    border: none;
    border-top: 1px solid #ddd;
  }

  @keyframes fadeIn {
    from {opacity:0; transform: translateY(-20px);}
    to {opacity:1; transform: translateY(0);}
  }
</style>
</head>
<body>
<div class="bg"></div>
<div class="overlay"></div>

<div class="container">
  <h2>ì‹ ê°€ë„¤ ë§ˆë‹ˆë˜ ê°œì¸ ì¡°íšŒ</h2>

  <input type="text" id="username" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" />
  <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
  <button onclick="checkManitto()">ì¡°íšŒ/ë“±ë¡</button>

  <div class="result" id="result"></div>

  <hr>
  <h3>ì°¸ì—¬ì ë¹„ë°€ë²ˆí˜¸ í™•ì¸ìš© (ê´€ë¦¬ìš©)</h3>
  <div id="passwordList"></div>
</div>

<script>
  const people = [
    "ì‹ ê´€ìš°", "ìš°ê²½í˜¸", "ì‹ ì€ì§€",
    "ì‹ ì„±ì‹", "ìµœì§€ì¸", "ì‹ ì´í˜„", "ì‹ ì´ì•„",
    "ì‹ ê´‘ì‹", "ë¥˜ì§„", "ì‹ ì„ í˜¸", "ì‹ ì§€ì•„"
  ];

  const families = {
    family1: ["ì‹ ê´€ìš°", "ìš°ê²½í˜¸", "ì‹ ì€ì§€"],
    family2: ["ì‹ ì„±ì‹", "ìµœì§€ì¸", "ì‹ ì´í˜„", "ì‹ ì´ì•„"],
    family3: ["ì‹ ê´‘ì‹", "ë¥˜ì§„", "ì‹ ì„ í˜¸", "ì‹ ì§€ì•„"]
  };

  let familyMap = {};
  for (const f in families) {
    families[f].forEach(name => familyMap[name] = f);
  }

  let passwordMap = {};
  let manittoMap = {};

  function createPassword() {
    return Math.random().toString(36).slice(2, 8);
  }

  function drawManitto() {
    let assigned = false;

    while (!assigned) {
      let candidates = [...people];
      let tempMap = {};
      let success = true;

      for (let person of people) {
        let available = candidates.filter(p => p !== person && familyMap[p] !== familyMap[person]);
        if (available.length === 0) {
          success = false;
          break;
        }
        let pick = available[Math.floor(Math.random() * available.length)];
        tempMap[person] = pick;
        candidates = candidates.filter(c => c !== pick);
      }

      if (success) {
        manittoMap = tempMap;
        assigned = true;
      }
    }
  }

  drawManitto();

  const result = document.getElementById("result");
  result.innerHTML = "<span class='highlight'>ì²˜ìŒ ì¡°íšŒ ì‹œì—ëŠ” ë¹„ë°€ë²ˆí˜¸ì— 0ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>";

  // URL íŒŒë¼ë¯¸í„°ë¡œ ì´ë¦„ ìë™ ì…ë ¥
  const urlParams = new URLSearchParams(window.location.search);
  const defaultName = urlParams.get('name');
  if(defaultName && people.includes(defaultName)){
      document.getElementById("username").value = defaultName;
  }

  function checkManitto() {
    const name = document.getElementById("username").value.trim();
    const pw = document.getElementById("password").value.trim();

    if (!people.includes(name)) {
      result.innerHTML = "<span class='highlight'>ë“±ë¡ë˜ì§€ ì•Šì€ ì´ë¦„ì…ë‹ˆë‹¤.</span>";
      return;
    }

    // ìµœì´ˆ ì¡°íšŒ
    if (!passwordMap[name]) {
      if (pw !== "0") {
        result.innerHTML = "<span class='highlight'>ì²˜ìŒ ì¡°íšŒ ì‹œì—ëŠ” ë¹„ë°€ë²ˆí˜¸ì— 0ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>";
        return;
      }

      const newPassword = createPassword();
      passwordMap[name] = newPassword;

      result.innerHTML = `ğŸ‰ <span class='highlight'>ìµœì´ˆ ë“±ë¡ ì™„ë£Œ!</span><br>
        ë‹¹ì‹ ì˜ ë§ˆë‹ˆë˜ëŠ” <span style="color:#007bff; font-weight:700;">${manittoMap[name]}</span><br>
        ê°œì¸ ë¹„ë°€ë²ˆí˜¸ëŠ”: <span class='highlight'>${newPassword}</span> ì…ë‹ˆë‹¤.`;

      updatePasswordList();
      return;
    }

    // ì´í›„ ì¡°íšŒ
    if (passwordMap[name] !== pw) {
      result.innerHTML = "<span class='highlight'>ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</span>";
      return;
    }

    result.innerHTML = `ğŸ ë‹¹ì‹ ì˜ ë§ˆë‹ˆë˜ëŠ” <br><br>
      <span style="font-size:22px;color:#007bff;">${manittoMap[name]}</span> ì…ë‹ˆë‹¤!`;
  }

  function updatePasswordList() {
    const passwordDiv = document.getElementById("passwordList");
    passwordDiv.innerHTML = "";
    people.forEach(name => {
      if (passwordMap[name]) {
        const p = document.createElement("p");
        p.textContent = `${name}: ${passwordMap[name]}`;
        passwordDiv.appendChild(p);
      }
    });
  }
</script>

</body>
</html>
